<!DOCTYPE HTML>
<html> 
  <head>
      <style>
          .Player {
            fill:#ffffff;
            stroke:#0000ff;
          }
      </style>
      
    <script type="text/javascript">
    // Global variables
    var X = 150; // Ball x position.
    var Y = 150; // Ball y position.
    
    var v = [0,0]; // Ball initial x velocity
    
    var v_max = 2; // max velocity
    
    var mass = 1;
    
    var impulse = [0,0];
    
    var p = [0, 0];
    console.log("velocty is " + v);
    console.log("momentum is " + p);
    
    
    /* The momentum principle:
       -----------------------
       
       An object has momentum. Momentum is determined
       as the mass of the object multiplied by the object's 
       velocity.
       
       py = vy * mass
       px = px * mass
       
       Force acts on momentum. The impulse is the force over dt.
       
       p = p + F/dt
    */
    
    var xmlns = "http://www.w3.org/2000/svg";
    
    // Quest: Find a way to land the traveller in the world
    var traveller = document.createElementNS(xmlns, "circle");      
    
    traveller.setAttributeNS(null,"x",50);
    traveller.setAttributeNS(null,"y",50);
    traveller.setAttributeNS(null,"r",50);
    traveller.setAttributeNS(null,"fill", "black");
    document.documentElement.appendChild(traveller);
    
    // This function is called on page load.

    function drawGameSVG() {

        // Play the game until the player stops.
        gameLoop = setInterval(drawBall, 1);

        // Add keyboard listener.
        window.addEventListener('keydown', whatKey, true);
        
    }

    function drawBall() {
        p = p + impulse;
        v = p / mass;
        
        X += v[0];
        Y += v[1];
        // Change the player location.
        player.setAttribute("cx", X);
        player.setAttribute("cy", Y);
	}

    // Get key press.
	function whatKey(evt) {

		switch (evt.keyCode) {
			// Left arrow.
			case 37:
            if ((v[0] + v_max) > 0) {  
                impulse[0] -= 1;
            }
            break;
			// Right arrow.
			case 39:
            if ((v[0] - v_max) < 0) {  
                impulse[0] += 1;
            }
			break;
			//Up arrow
			case 38:
			if ((v[1] + v_max) > 0) {  
                impulse[1] -= 1;
            }
			break;
			//Down arrow
			case 40:
			if ((v[1] - v_max) < 0) {  
                impulse[1] += 1;
            }
			break;
		}
	}
    </script>
  </head>
  
  <body onload="drawGameSVG()">
    <h1>
      Quest Complete
    </h1>
    <!-- Create the SVG pane. -->
    <svg xmlns="http://www.w3.org/2000/svg" height="501" width="501">
      <!-- Create the board. -->
	  <defs>
	  <pattern id="smallGrid" width="10" height="10" patternUnits="userSpaceOnUse">
		<path d="M 10 0 L 0 0 0 10" fill="none" stroke="lightblue" stroke-width="1"/>
	  </pattern>
	  <pattern id="grid" width="100" height="100" patternUnits="userSpaceOnUse">
		<rect width="100" height="100" fill="url(#smallGrid)"/>
		<path d="M 100 0 L 0 0 0 100" fill="none" stroke="blue" stroke-width="1"/>
	  </pattern>
	</defs>

    <rect width="100%" height="100%" fill="url(#grid)" />
    <!-- Create the player. -->
    <circle
        class="Player"
        cx="150" 
        cy="150" 
        r="15" 
        id="player" />
     
    </svg>
  </body>

</html>

